---
layout: base
title: ShihGPTMD Interface
permalink: /shihgptmd.html
---

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ShihGPTMD Interface</title>
    <style>
        body { font-family: sans-serif; margin: 20px; }
        .container { max-width: 900px; margin: auto; padding: 20px; border: 1px solid #ccc; border-radius: 8px; }
        .hidden { display: none; }
        label { display: block; margin-top: 10px; margin-bottom: 5px; font-weight: bold; }
        textarea, select { width: 100%; padding: 8px; margin-bottom: 15px; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
        button { padding: 10px 15px; background-color: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; }
        button:hover { background-color: #0056b3; }
        .text-hidden-on-white { color: white !important; background-color: white !important; border-color: white !important; }
        #mainOutputArea, #patientInfoInput, #epicSmartPhraseInput { min-height: 150px; }
        .checkbox-area label { font-weight: normal; display: inline-block; margin-right: 15px;}
        .section-title { margin-top: 20px; margin-bottom:10px; font-size: 1.2em; border-bottom: 1px solid #eee; padding-bottom: 5px;}
    </style>
</head>
<body>

    <div id="passwordPrompt">
        <h2>Enter Password</h2>
        <input type="password" id="passwordInput" placeholder="Password">
        <button onclick="checkPassword()">Submit</button>
        <p id="passwordError" style="color: red;"></p>
    </div>

    <div id="appContent" class="container hidden">
        <h1>ShihGPT-MD Interface</h1>

        <div class="checkbox-area">
            <input type="checkbox" id="hideTextCheckbox" name="hideTextCheckbox">
            <label for="hideTextCheckbox">Hide screen text (white on white)</label>
        </div>

        <h2 class="section-title">Patient Information</h2>
        <textarea id="patientInfoInput" placeholder="Enter patient information here..."></textarea>

        <h2 class="section-title">EPIC SmartPhrase Template (Optional)</h2>
        <textarea id="epicSmartPhraseInput" placeholder="Paste EPIC SmartPhrase template here if desired..."></textarea>

        <h2 class="section-title">Note Options</h2>
        <label for="templateSelector">Select Predefined Template:</label>
        <select id="templateSelector">
            <option value="general_soap">General SOAP Note</option>
            <option value="ob_l_d">OB L&D</option>
            <option value="derm_lesion">Derm Lesion</option>
            <option value="peds_well_visit">Peds Well Visit</option>
            <!-- Add more templates as needed -->
        </select>

        <h3>Checkbox Options:</h3>
        <div id="checkboxOptionsContainer" style="margin-bottom: 20px;">
            <!-- Checkboxes will be dynamically added here by JS -->
        </div>

        <button id="generatePromptButton" style="margin-top:20px;">Generate Full Prompt for LLM</button>

        <h2 class="section-title">Generated Prompt / Output Note</h2>
        <textarea id="mainOutputArea" placeholder="Generated prompt or LLM output will appear here..." readonly></textarea>

        <h2 class="section-title">Synced Notes (from Google Drive)</h2>
        <div id="googleDriveEmbed">
            <p><em>(Google Drive folder will be embedded here)</em></p>
        </div>

    </div>

    <script>
        // Basic password protection (replace 'yourpassword' with a real one, ideally managed more securely)
        // This is for basic deterrence, not strong security.
        const CORRECT_PASSWORD = "password123"; // CHANGE THIS!

        function checkPassword() {
            const password = document.getElementById('passwordInput').value;
            if (password === CORRECT_PASSWORD) {
                document.getElementById('passwordPrompt').classList.add('hidden');
                document.getElementById('appContent').classList.remove('hidden');
                document.getElementById('passwordError').textContent = '';
            } else {
                document.getElementById('passwordError').textContent = 'Incorrect password.';
            }
        }

        // Hide text feature
        document.addEventListener('DOMContentLoaded', function() {
            const hideCheckbox = document.getElementById('hideTextCheckbox');
            // Target multiple text areas for the hide text feature
            const textAreasToHide = [
                document.getElementById('patientInfoInput'),
                document.getElementById('epicSmartPhraseInput'),
                document.getElementById('mainOutputArea')
            ];

            if (hideCheckbox) {
                hideCheckbox.addEventListener('change', function() {
                    textAreasToHide.forEach(textArea => {
                        if (textArea) {
                            if (this.checked) {
                                textArea.classList.add('text-hidden-on-white');
                            } else {
                                textArea.classList.remove('text-hidden-on-white');
                            }
                        }
                    });
                });
            }
        });

        const checkboxOptions = [
            { id: "genSHN", label: "Generate SHN (Short-hand Notation)", group: "Output Format" },
            { id: "genVSHN", label: "Generate VSHN (Very Short-hand Notation)", group: "Output Format" },
            { id: "incPathophys", label: "Include full pathophysiologic reasoning", group: "Reasoning Detail" },
            { id: "incGuidelines", label: "Include guideline citations if relevant", group: "Reasoning Detail" },
            { id: "expectImage", label: "Expect image input", group: "Data Type Emphasis" },
            { id: "expectAudio", label: "Expect audio input", group: "Data Type Emphasis" },
            { id: "expectStructured", label: "Expect structured vitals/labs", group: "Data Type Emphasis" },
            { id: "formatSOAP", label: "SOAP format", group: "Documentation Type", checked: true }, // Default
            { id: "formatHnP", label: "Full H&P", group: "Documentation Type" },
            { id: "formatDischarge", label: "Discharge summary", group: "Documentation Type" },
            { id: "formatPreOp", label: "Pre-op note", group: "Documentation Type" },
            { id: "specOBGYN", label: "OB/GYN", group: "Specialty Context" },
            { id: "specDerm", label: "Derm", group: "Specialty Context" },
            { id: "specPeds", label: "Peds", group: "Specialty Context" },
            { id: "specOrtho", label: "Ortho", group: "Specialty Context" },
            { id: "specIM", label: "Internal Medicine", group: "Specialty Context" },
            { id: "incMissingData", label: "Include checklist of missing objective data", group: "Output Features" },
            { id: "genPatientQuestions", label: "Generate initial patient questions", group: "Output Features" },
            { id: "incTTS", label: "Insert TTS audio (if supported by backend)", group: "Output Features" },
            { id: "confirmDeidentified", label: "Confirm data is de-identified", group: "Redaction", checked: true }, // Default
            { id: "removeDates", label: "Remove dates (convert to relative time)", group: "Redaction" },
            { id: "stripNonStandardAbbr", label: "Strip nonstandard abbreviations", group: "Redaction" }
        ];

        function populateCheckboxOptions() {
            const container = document.getElementById('checkboxOptionsContainer');
            container.innerHTML = ''; // Clear existing
            let currentGroup = "";
            checkboxOptions.forEach(opt => {
                if (opt.group !== currentGroup) {
                    currentGroup = opt.group;
                    const groupTitle = document.createElement('h4');
                    groupTitle.textContent = currentGroup;
                    groupTitle.style.marginTop = '15px';
                    groupTitle.style.marginBottom = '5px';
                    container.appendChild(groupTitle);
                }
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.id = opt.id;
                checkbox.name = opt.id;
                checkbox.value = opt.id;
                if (opt.checked) {
                    checkbox.checked = true;
                }

                const label = document.createElement('label');
                label.htmlFor = opt.id;
                label.appendChild(document.createTextNode(opt.label));
                label.style.fontWeight = 'normal';
                label.style.marginLeft = '5px';
                label.style.marginRight = '15px';

                const div = document.createElement('div');
                div.appendChild(checkbox);
                div.appendChild(label);
                container.appendChild(div);
            });
        }

        function generateFullPrompt() {
            const patientInfo = document.getElementById('patientInfoInput').value;
            const epicSmartPhrase = document.getElementById('epicSmartPhraseInput').value;
            const selectedTemplate = document.getElementById('templateSelector').value;
            const outputArea = document.getElementById('mainOutputArea');

            let prompt = `You are ShihGPT-MD, an attending-level physician model.
Remove all patient names and MRNs.
Reanalyze every question and recommendation for accuracy with the rigor of an attending.

Patient Information:
---
${patientInfo}
---
`;

            if (epicSmartPhrase.trim() !== "") {
                prompt += `\nEPIC SmartPhrase Template to use for output format:
---
${epicSmartPhrase}
---
Instruct the model to fill this template. If information for a field is not available, leave the field placeholder as is or indicate 'not available'.
`;
            } else {
                prompt += `\nSelected Predefined Template: ${selectedTemplate}\n`;
            }

            prompt += "\nSelected Options:\n";
            let hasSelectedOption = false;
            checkboxOptions.forEach(opt => {
                const checkbox = document.getElementById(opt.id);
                if (checkbox && checkbox.checked) {
                    prompt += `- ${opt.label}\n`;
                    hasSelectedOption = true;
                }
            });
            if (!hasSelectedOption) {
                prompt += "- (No specific checkbox options selected)\n";
            }
            
            prompt += `
Core Instructions:
- If this is a new patient, generate initial questions based on their case that are thorough, guideline-concordant, and relevant for diagnostic clarity. Also begin a working impression and full assessment and plan using available data. Use current clinical guidelines where appropriate.
- Update the note each time new information (text, image, audio) is received, placing the new content in the appropriate section. If data is missing (e.g. vital signs, labs, imaging), state which ones are needed, why, and under what criteria.
- Include:
    - Impression: 1-liner with age, sex (if known), relevant background, and primary concern or diagnosis
    - Subjective: HPI + relevant PMH, SHx, FHx, ROS
    - Objective: Include available vitals, PE, labs/imaging
    - Assessment & Plan: Fully reasoned differential, most likely diagnosis, relevant pathophysiology, and plan with specific interventions and follow-up

Output Formatting based on selections:
- If "Generate SHN" is selected: Rephrase full note using standard clinical abbreviations while maintaining clarity.
- If "Generate VSHN" is selected: Distill into ultra-concise, rapid-style shorthand, omitting non-critical detail and avoiding uncommon abbreviations or unnecessary caps.
(If both SHN and VSHN are selected, prioritize VSHN or clarify desired combined behavior).

Reasoning Detail:
- If "Include full pathophysiologic reasoning" is selected, ensure this is present in the Assessment & Plan.
- If "Include guideline citations if relevant" is selected, add these where appropriate.

Data Type Emphasis:
- Adapt interaction if "Expect image input", "Expect audio input", or "Expect structured vitals/labs" is indicated.

Documentation Type:
- Prioritize the selected format (SOAP, Full H&P, Discharge, Pre-op) if no EPIC SmartPhrase is provided.

Specialty Context:
- Tailor questions, assessment, and plan to the selected specialty (OB/GYN, Derm, Peds, Ortho, Internal Medicine).

Output Features:
- If "Include checklist of missing objective data" is selected, provide this.
- If "Generate initial patient questions" is selected, ensure these are present for new patients.
- If "Insert TTS audio" is selected, note that the output text should be suitable for TTS (backend would handle actual audio).

Redaction:
- Default: "Confirm data is de-identified".
- If "Remove dates (convert to relative time)" is selected, apply this.
- If "Strip nonstandard abbreviations" is selected, ensure output clarity.

---
BEGIN MODEL RESPONSE BASED ON ABOVE INSTRUCTIONS AND PATIENT DATA:
`;

            outputArea.value = prompt;
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            // Existing hideTextCheckbox logic...
            const hideCheckbox = document.getElementById('hideTextCheckbox');
            const textAreasToHide = [
                document.getElementById('patientInfoInput'),
                document.getElementById('epicSmartPhraseInput'),
                document.getElementById('mainOutputArea')
            ];

            if (hideCheckbox) {
                hideCheckbox.addEventListener('change', function() {
                    textAreasToHide.forEach(textArea => {
                        if (textArea) {
                            if (this.checked) {
                                textArea.classList.add('text-hidden-on-white');
                            } else {
                                textArea.classList.remove('text-hidden-on-white');
                            }
                        }
                    });
                });
            }
            // End of existing hideTextCheckbox logic

            populateCheckboxOptions(); // Populate checkboxes on load

            const generateButton = document.getElementById('generatePromptButton');
            if (generateButton) {
                generateButton.addEventListener('click', generateFullPrompt);
            }

            console.log("ShihGPTMD page loaded. Password, hide text, checkboxes, and prompt generation initialized.");
        });

    </script>
</body>
</html>
